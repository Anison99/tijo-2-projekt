<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Katalog Książek</title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<body>
<object type="text/html" data="navbar.html" width="100%" height="50px"></object>

<div class="container mt-4">
    <h1>Katalog Książek</h1>

    <!-- Tabela książek -->
    <table class="table table-bordered">
        <thead>
        <tr>
            <th>Tytuł</th>
            <th>Autor</th>
            <th>Status</th>
            <th>Akcje</th>
        </tr>
        </thead>
        <tbody id="book-list">
        <!-- Tutaj będą dodane książki -->
        </tbody>
    </table>
</div>

<script>
$(document).ready(function() {
    function loadBookList() {
        $.ajax({
            url: '/api/book',
            type: 'GET',
            success: function(books) {
                var tableBody = $('#book-list');
                tableBody.empty();

                books.forEach(function(book) {
                    var bookStatus = book.isReserved ? 'Zarezerwowana' : 'Dostępna';
                    var reserveButton = book.isReserved ? '' : '<button class="btn btn-primary reserve-book" data-id="' + book.id + '">Rezerwuj</button>';

                    tableBody.append(
                        '<tr>' +
                        '<td>' + book.title + '</td>' +
                        '<td>' + book.author + '</td>' +
                        '<td>' + bookStatus + '</td>' +
                        '<td>' + reserveButton + '</td>' +
                        '</tr>'
                    );
                });
            },
            error: function() {
                alert("Błąd podczas ładowania listy książek.");
            }
        });
    }

    $(document).on('click', '.reserve-book', function() {
        var bookId = $(this).data('id');
        // Wyślij żądanie rezerwacji książki do backendu
        $.ajax({
            url: '/api/book/reserve/' + bookId,
            type: 'POST',
            success: function() {
                alert("Książka została zarezerwowana.");
                loadBookList();
            },
            error: function() {
                alert("Błąd podczas rezerwacji książki.");
            }
        });
    });

    loadBookList();
});
</script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>
